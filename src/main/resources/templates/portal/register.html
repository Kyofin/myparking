<!doctype html>
<html class="no-js">
<head>

  <title>registerPage</title>
  <#include "/portal/amazedHead.html">

</head>
<body>
<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
  以获得更好的体验！</p>
<![endif]-->


<#include "/portal/header.html">

<div class="am-cf admin-main">
  <!-- sidebar start -->
  <!--<div class="admin-sidebar am-offcanvas" id="admin-offcanvas">-->
    <!--<div class="am-offcanvas-bar admin-offcanvas-bar">-->
      <!--<ul class="am-list admin-sidebar-list">-->
        <!--<li><a href="admin-index.html"><span class="am-icon-home"></span> 首页</a></li>-->
        <!--<li class="admin-parent">-->
          <!--<a class="am-cf" data-am-collapse="{target: '#collapse-nav'}"><span class="am-icon-file"></span> 页面模块 <span class="am-icon-angle-right am-fr am-margin-right"></span></a>-->
          <!--<ul class="am-list am-collapse admin-sidebar-sub am-in" id="collapse-nav">-->
            <!--<li><a href="admin-user.html" class="am-cf"><span class="am-icon-check"></span> 个人资料<span class="am-icon-star am-fr am-margin-right admin-icon-yellow"></span></a></li>-->
            <!--<li><a href="admin-help.html"><span class="am-icon-puzzle-piece"></span> 帮助页</a></li>-->
            <!--<li><a href="admin-gallery.html"><span class="am-icon-th"></span> 相册页面<span class="am-badge am-badge-secondary am-margin-right am-fr">24</span></a></li>-->
            <!--<li><a href="admin-log.html"><span class="am-icon-calendar"></span> 系统日志</a></li>-->
            <!--<li><a href="admin-404.html"><span class="am-icon-bug"></span> 404</a></li>-->
          <!--</ul>-->
        <!--</li>-->
        <!--<li><a href="admin-table.html"><span class="am-icon-table"></span> 表格</a></li>-->
        <!--<li><a href="admin-form.html"><span class="am-icon-pencil-square-o"></span> 表单</a></li>-->
        <!--<li><a href="#"><span class="am-icon-sign-out"></span> 注销</a></li>-->
      <!--</ul>-->

      <!--<div class="am-panel am-panel-default admin-sidebar-panel">-->
        <!--<div class="am-panel-bd">-->
          <!--<p><span class="am-icon-bookmark"></span> 公告</p>-->
          <!--<p>时光静好，与君语；细水流年，与君同。—— Amaze UI</p>-->
        <!--</div>-->
      <!--</div>-->

      <!--<div class="am-panel am-panel-default admin-sidebar-panel">-->
        <!--<div class="am-panel-bd">-->
          <!--<p><span class="am-icon-tag"></span> wiki</p>-->
          <!--<p>Welcome to the Amaze UI wiki!</p>-->
        <!--</div>-->
      <!--</div>-->
    <!--</div>-->
  <!--</div>-->
  <!-- sidebar end -->

  <!-- content start -->
  <div class="admin-content">
    <div class="admin-content-body">
      <div class="am-cf am-padding am-padding-bottom-0">
        <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">个人资料</strong> / <small>Personal information</small></div>
      </div>

      <hr/>

      <div class="am-g">
        <div class="am-u-sm-12 am-u-md-4 am-u-md-push-8">
          <div class="am-panel am-panel-default">
            <div class="am-panel-bd">
              <div class="am-g">
                <div id="headImage" class="am-u-md-4">
                </div>
                <div class="am-u-md-8">
                  <p>你可以使用本地上传头像。 </p>
                  <form id="fileForm" action="" class="am-form">
                    <div class="am-form-group am-form-file" id="my-upload">
                      <input type="hidden" id="user-headUrl" name="headUlr" />
                      <input type="file" name="file" id="doc-form-file">
                      <button class="am-btn am-btn-danger am-btn-sm">
                      <i class="am-icon-cloud-upload">上传</i>
                      </button>
                    </div>
                    <div id="file-list"></div>
                  </form>


                </div>
              </div>
            </div>
          </div>

          <!--<div class="am-panel am-panel-default">-->
            <!--<div class="am-panel-bd">-->
              <!--<div class="user-info">-->
                <!--<p>等级信息</p>-->
                <!--<div class="am-progress am-progress-sm">-->
                  <!--<div class="am-progress-bar" style="width: 60%"></div>-->
                <!--</div>-->
                <!--<p class="user-info-order">当前等级：<strong>LV8</strong> 活跃天数：<strong>587</strong> 距离下一级别：<strong>160</strong></p>-->
              <!--</div>-->
              <!--<div class="user-info">-->
                <!--<p>信用信息</p>-->
                <!--<div class="am-progress am-progress-sm">-->
                  <!--<div class="am-progress-bar am-progress-bar-success" style="width: 80%"></div>-->
                <!--</div>-->
                <!--<p class="user-info-order">信用等级：正常当前 信用积分：<strong>80</strong></p>-->
              <!--</div>-->
            <!--</div>-->
          <!--</div>-->

        </div>

        <div class="am-u-sm-12 am-u-md-8 am-u-md-pull-4">
          <form class="am-form am-form-horizontal">
            <div class="am-form-group">
              <label for="user-name" class="am-u-sm-3 am-form-label">账号 / UserName</label>
              <div class="am-u-sm-9">
                <input type="text" id="user-name" name="username" placeholder="账号 / UserName">
                <small>输入你的账号名，让我们记住你。</small>
              </div>
            </div>

            <div class="am-form-group">
              <label for="user-nick-name" class="am-u-sm-3 am-form-label">昵称 / NickName</label>
              <div class="am-u-sm-9">
                <input type="text" id="user-nick-name" name="nickname" placeholder="昵称 / NickName">
                <small>输入你的昵称</small>
              </div>
            </div>

            <div class="am-form-group">
              <label for="user-password" class="am-u-sm-3 am-form-label">密码 / Password</label>
              <div class="am-u-sm-9">
                <input type="password" name="password" id="user-password" placeholder="密码 / Password">
                <small>输入你的密码。</small>
              </div>
            </div>

            <div class="am-form-group">
              <label for="user-email" class="am-u-sm-3 am-form-label">电子邮件 / Email</label>
              <div class="am-u-sm-9">
                <input type="email" name="email" id="user-email" placeholder="输入你的电子邮件 / Email">
                <small>邮箱可接收停车库系统发出的通知</small>
              </div>
            </div>



            <div class="am-form-group">
              <div class="am-u-sm-9 am-u-sm-push-3">
                <button type="button" id="submitBtn" class="am-btn am-btn-primary">注册</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <#include "/portal/footer.html">


  </div>
  <!-- content end -->

</div>

<!--<a href="#" class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu" data-am-offcanvas="{target: '#admin-offcanvas'}"></a>-->




<script src="/assets/js/app.js"></script>
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/jquery.form.js"></script>


<!--todo 注册的js未完成 ，上传文件的js未完成-->
<script>
    $(function() {
        $('#doc-form-file').on('change', function() {
            var fileNames = '';
            $.each(this.files, function() {
                fileNames += '<span class="am-badge">' + this.name + '</span> ';
            });
            $('#file-list').html(fileNames);

            subimtFile();

        });

        $("#submitBtn").on("click",function () {
            $.post("/portal/user/register",{
                username:$("#user-name").val(),
                password:$("#user-password").val(),
                nickname:$("#user-nick-name").val(),
                headUrl:$("#user-headUrl").val(),
                email:$("#user-email").val()

            },function (res) {
                var obj = JSON.parse(res);
                if(obj.code == 0){
                    alert("注册成功");
                    window.location.href="/portal/user/indexPage";
                }else {
                    alert(obj.error);
                }

            })
        })

        function subimtFile() {
            var form = $("#fileForm");
            var options = {
                url:'/portal/user/uploadImage', //上传文件的路径
                type:'post',
                success:function(data){
                    var obj = JSON.parse(data);
                    console.log(obj.msg);
                    //....       //异步上传成功之后的操作
                    $("#user-headUrl").val(obj.msg);
                    $("#headImage").html('<img class="am-img-circle am-img-thumbnail" src="'+$("#user-headUrl").val()+'" alt=""/>')
                }
            };
            form.ajaxSubmit(options);
        }

    });
</script>

</body>
</html>
